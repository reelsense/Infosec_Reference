## Malware

### TOC

* [General](#general)
* [Tutorials](#tutorial)
* [Writeups](#writeup)
* [Malware Repositories](#repository)
* [Mobile](#mobile)
* [Anti-VM/Detecting VMs](#antivm)
* [Tools](#tools)
* [Static Analysis](#static)
* [Dynamic Analysis](#dynamic)
* [AV Evasion/Encoders/Packers](#packers)
* [Papers](#papers)
* [Talks](#talks)
* [Other](#other)

### Sort

* sort tools
* Add malicious document section
* http://securityxploded.com/malware-analysis-training-reference.php
* http://www.malwarearchaeology.com/mmf/
* https://motherboard.vice.com/read/preserving-the-ancient-art-of-getting-pwned
* http://www.exposedbotnets.com/?m=0
* https://brycampbell.co.uk/new-blog/ https://archive.is/Nol3S Add
* Stuxnet
* Duqu
* Flame
* Itaduke
* Packers _ mew _ ASPROTECT _ UPX _ FSG \* PESpin

* [IcoScript: using webmail to control malware](https://www.virusbulletin.com/virusbulletin/2014/08/icoscript-using-webmail-control-malware)
* [fastfluxanalysis](https://github.com/staaldraad/fastfluxanalysis)

  * Scripts to detect Fast-Flux and DGA using DNS query responses

* [Interesting Malware - No, I’m not kidding... by Marion Marschalek](https://www.youtube.com/watch?v=u2Ry9HTBbZI)
* [rVMI - A New Paradigm For Full System Analysis](https://github.com/fireeye/rvmi)

  * rVMI is a debugger on steroids. It leverages Virtual Machine Introspection
    (VMI) and memory forensics to provide full system analysis. This means that
    an analyst can inspect userspace processes, kernel drivers, and preboot
    environments in a single tool. It was specifially designed for interactive
    dynamic malware analysis. rVMI isolates itself from the malware by placing
    its interactive debugging environment out of the virtual machine (VM) onto
    the hypervisor-level. Through the use of VMI the analyst still has full
    control of the VM, which allows her to pause the VM at any point in time and
    to use typical debugging features such as breakpoints and watchpoints. In
    addtion, rVMI provides access to the entire Rekall feature set, which
    enables an analyst to inspect the kernel and its data structures with ease.

* [PyTrigger: A System to Trigger & Extract User-Activated Malware Behavior](http://cs.gmu.edu/~astavrou/research/PyTrigger_ARES2013.pdf)

  * Abstract: We introduce PyTrigger, a dynamic malware analy- sis system that
    automatically exercises a malware binary extract- ing its behavioral profile
    even when specific user activity or input is required. To accomplish this,
    we developed a novel user activity record and playback framework and a new
    behavior extraction approach. Unlike existing research, the activity
    recording and playback includes the context of every object in addition to
    traditional keyboard and mouse actions. The addition of the con- text makes
    the playback more accurate and avoids dependenciesand pitfalls that come
    with pure mouse and keyboard replay. Moreover, playback can become more
    efficient by condensing common activities into a single action. After
    playback, PyTrigger analyzes the system trace using a combination of
    multiple states and behavior differencing to accurately extract the malware
    behavior and user triggered behavior from the complete system trace log. We
    present the algorithms, architecture and evaluate the PyTrigger prototype
    using 3994 real malware samples. Results and analysis are presented showing
    PyTrigger extracts additional behavior in 21% of the samples

* [Windows’ PsSetLoadImageNotifyRoutine Callbacks: the Good, the Bad and the Unclear (Part 2)](https://breakingmalware.com/documentation/windows-pssetloadimagenotifyroutine-callbacks-good-bad-unclear-part-2/)

##### To Do

* Sort Tools
* Clean up/organize

### First Section

* [Awesome Malware Analysis - Github Awesome List series](https://github.com/rshipp/awesome-malware-analysis)
* [TIPS FOR REVERSE - ENGINEERING MALICIOUS CODE - Lenny Zeltser](https://zeltser.com/media/docs/reverse-engineering-malicious-code-tips.pdf)
* [List of autorun keys / malware persistence Windows registry entries](https://www.peerlyst.com/posts/list-of-autorun-keys-malware-persistence-windows-registry-entries-benjamin-infosec)
* [Computer Viruses In This Modern Age - alcopaul/brigada ocho 2014](http://spth.virii.lu/dc6/TEXTS/alcopaul/virus_alcopaul.txt)

### Tutorials

* [Reverse Engineering Malware 101 Material - Malware Unicorn](https://securedorg.github.io/RE101/)
* [Malware Analysis Tutorials: a Reverse Engineering Approach - Dr Xiang Fu](https://fumalwareanalysis.blogspot.com/p/malware-analysis-tutorials-reverse.html)
* [Malware Analysis Tutorials: a Reverse Engineering Approach](http://fumalwareanalysis.blogspot.com/p/malware-analysis-tutorials-reverse.html)
* [Malware Analysis 101 - N00b to Ninja in 60 Minutes at CactusCon on April 4, 2014](https://www.slideshare.net/grecsl/malware-analysis-101-n00b-to-ninja-in-60-minutes-at-cactuscon-on-april-4-2014)
* [Creating a Malware Sandbox in Seconds with Noriben.](http://www.ghettoforensics.com/2016/01/creating-malware-sandbox-in-seconds.html?m=1)
* [Building a Home Lab to Become a Malware Hunter - A Beginner’s Guide](https://www.alienvault.com/blogs/security-essentials/building-a-home-lab-to-become-a-malware-hunter-a-beginners-guide)
* [Cuckoo Sandbox Hardening(2013)](http://0xmalware.blogspot.com/2013/10/cuckoo-sandbox-hardening-virtualbox.html)
* [Awesome Guide to building a VM for anonymous Malware Analysis and Reverse Engineering](https://www.codeandsec.com/Building-Ultimate-Anonymous-Malware-Analysis-and-Reverse-Engineering-Machine)
* [malboxes](https://github.com/GoSecure/malboxes)

  * Builds malware analysis Windows VMs so that you don't have to.

* [Advanced Desktop Application Sandboxing via AppContainer](https://www.malwaretech.com/2015/09/advanced-desktop-application-sandboxing.html)

### Sandboxes

* [Limon - Sandbox for Analyzing Linux Malwares](https://github.com/monnappa22/Limon)
* [Truman](http://www.secureworks.com/cyber-threat-intelligence/tools/truman/)

  * Truman can be used to build a "sandnet", a tool for analyzing malware in an
    environment that is isolated, yet provides a virtual Internet for the
    malware to interact with. It runs on native hardware, therefore it is not
    stymied by malware which can detect VMWare and other VMs. The major
    stumbling block to not using VMs is the difficulty involved with repeatedly
    imaging machines for re-use. Truman automates this process, leaving the
    researcher with only minimal work to do in order to get an initial analysis
    of a piece of malware. Truman consists of a Linux boot image (originally
    based on Chas Tomlin's Windows Image Using Linux) and a collection of
    scripts. Also provided is pmodump, a Perl-based tool to reconstruct the
    virtual memory space of a process from a PhysicalMemory dump. With this tool
    it is possible to circumvent most packers to perform strings analysis on the
    dumped malware. General Tutorials

* [A Guide to Malware Binary Reconstruction](https://github.com/0xAX/linux-insides/blob/master/Misc/contribute.md)
* [Automating Removal of JS Obfuscators](http://www.contextis.com/resources/blog/automating-removal-java-obfuscation/)

  * In this post we detail a method to improve analysis of Java code for a
    particular obfuscator, we document the process that was followed and
    demonstrate the results of automating our method. Obscurity will not stop an
    attacker and once the method is known, methodology can be developed to
    automate the process.

* [DIY Android Malware Analysis with OBAD](http://securityintelligence.com/diy-android-malware-analysis-taking-apart-obad-part-1/)
* [ ZeroAccess Malware - Part 1 De-Obfuscating and Reversing the User-Mode Agent Dropper](http://resources.infosecinstitute.com/step-by-step-tutorial-on-reverse-engineering-malware-the-zeroaccessmaxsmiscer-crimeware-rootkit/)

### General/Writeups

* [Analyzing unknown malware blogpost series](http://thegoldenmessenger.blogspot.com/)

### Android

* [How To Dissect Android Flappy Bird Malware](http://securehoney.net/blog/how-to-dissect-android-flappy-bird-malware.html)
* [Hacking Team Writeup](https://citizenlab.org/2014/06/backdoor-hacking-teams-tradecraft-android-implant/)
* [Android/Beita.A malware analysis](http://www.jamesejr.com/android-beita-malware-analysis/)
* [Android Sandbox V1](http://androidsandbox.net/)
* [Cuckoo-Droid](https://github.com/i[danr1986/cuckoo-droid/blob/master/README.md)

  * CuckooDroid is an extension of Cuckoo Sandbox the Open Source software for
    automating analysis of suspicious files, CuckooDroid brigs to cuckoo the
    capabilities of execution and analysis of android application.

### Obfuscators

* [ProGuard](http://proguard.sourceforge.net/)
* [DexGuard](http://www.saikoa.com/dexguard)
* [Obfuscation in Android malware, and how to fight back](https://www.virusbtn.com/virusbulletin/archive/2014/07/vb201407-Android-obfuscation)

  [Obfuscation in Android Malware and how to fight back](https://www.virusbtn.com/virusbulletin/archive/2014/07/vb201407-Android-obfuscation)

### De-Obfuscators

* [De-hoser](https://github.com/strazzere/dehoser)

  * Unpacker for the HoseDex2Jar APK Protection which packs the original file
    inside the dex header

* [hidex](https://github.com/cryptax/dextools/tree/master/hidex)

  * Hides or reveals a given method in a DEX file

* [Android Unpacker presented at Defcon 22: Android Hacker Protection Level 0](https://github.com/strazzere/android-unpacker)

* Native-unpacker - Unpacker for APKProtect/Bangcle/LIAPP/Qihoo Packer that runs
  natively, no dependency on gdb
* hide-qemu

  * Small hacks for hidingthe qemu/debuggers, specifically from APKProtect

### Packers

* [Android Packers](http://www.fortiguard.com/uploads/general/Area41Public.pdf)

### APTs

* [Clean up on Aisle APT - Mark Parsons](https://www.irongeek.com/i.php?page=videos/bsidescharm2017/bsidescharm-2017-t101-clean-up-on-aisle-apt-mark-parsons)

  * This presentation will discuss findings from running multiple sinkholes over
    the past year. I have purchased multiple domains associated with 'APT'
    activity after the domains have expired. I will discuss initial expectations
    before beginning this journey and then discuss actual results and findings.
    To assist other researchers, suggestions and lessons learned from this
    experiment will be shared.

* [Decoding ZeuS disguised as an .RTF File](http://phishme.com/decoding-zeus-disguised-as-an-rtf-file/)

  * Excellent step by step writeup

* [FinFisher Malware Dropper Analysis](https://www.codeandsec.com/FinFisher-Malware-Dropper-Analysis)
* [North Korean Malware Writeup](https://www.codeandsec.com/Supreme-Leaders-Not-That-Supreme-Malwares)
* [Regin Malware writeup by F-Secure](https://www.f-secure.com/weblog/archives/00002774.html)
* [Fanny Malware Writeup](https://securelist.com/blog/research/68787/a-fanny-equation-i-am-your-father-stuxnet/)
* [The DUQU 2.0 Technical Details - Kaspersky](https://cdn.securelist.com/files/2015/06/The_Mystery_of_Duqu_2_0_a_sophisticated_cyberespionage_actor_returns.pdf)
* [Unmasking Careto through Memory Analysis - Andrew Case](http://2014.video.sector.ca/video/110388398)
  [Hacking FinSpy - a Case Study - Atilla Marosi - [TROOPERS15]](https://www.youtube.com/watch?v=Mb4mfBi06K4)
* FinFisher - CodeandSec

  * [Part 1](https://www.codeandsec.com/FinFisher-Malware-Dropper-Analysis)
  * [Part 2](https://www.codeandsec.com/FinFisher-Malware-Analysis-Part-2)
  * [Part 3](https://www.codeandsec.com/FinFisher-Malware-Analysis-Part-3)

* [To Catch a Spy Tyler Hudak - Derbycon7](https://www.youtube.com/watch?v=usyCWf3gsQ4)
* [ZitMo NoM - Derbycon2014](https://www.irongeek.com/i.php?page=videos/derbycon4/t520-zitmo-nom-david-schwartzberg)

  * A world without malware is ideal but unlikely. Many of us would prefer
    \*not\* to install another layer of protection on their already resource
    constrained handheld mobile device. Alternatively, Android malware detection
    sans anti-virus installation has become a reality. Learn about how it’s
    possible to detect mobile malware using simple text messages with ZitMo NoM.
    ZeuS in the mobile, known as ZitMo, is infamous for intercepting SMS
    transmissions then redirecting them to a Command & Control in order steal
    banking and personal information. Research with SMS transmissions directed
    at mobile malware has resulted in the ability to detect ZitMo’s presence
    without anti,virus applications installed. Turning their own tools against
    them makes this even more of a rewarding endeavor. We are looking for
    malware researchers to contribute to the continued development of this open
    tool. The presentation will include the research, the infrastructure and a
    demonstration of ZitMo NoM. Live malware will be used during this
    presentation, assuming we get it to behave.

* [Malware: From your text editor, to the United States Government's Lab (SHA2017)](https://www.youtube.com/watch?v=PtufumVvN-E)

  * How Universities in the US collaborate with the United States Government to
    make America stronger, and the rest weaker. Ever wonder where your malware
    ends up after you deploy it? Are you curious how the United States
    Government researches Cyber Security on the backs of students? First, this
    is not a technical talk. This is an informative talk on the insides of how
    the inner workings of an Information Security Lab in one of the Top
    Technical Universities in the United States works with its Government to
    provide insights in the world of, as the feds like to call it,
    "CyberSecurity". (All Americans apologize for Trump. We're sorry.)

* [Keep Calm and (Don’t) Enable Macros: A New Threat Actor Targets UAE Dissidents](https://citizenlab.org/2016/05/stealth-falcon/)

  * Axiom Threat Actor Group Report
  * [Executive Summary](http://www.novetta.com/files/9714/1446/8199/Executive_Summary-Final_1.pdf)

### AV

* [Escaping The Avast Sandbox Using A Single IOCTL](https://www.nettitude.co.uk/escaping-avast-sandbox-using-single-ioctl-cve-2016-4025)
* [AVLeak: Fingerprinting Antivirus Emulators Through Black-Box Testing](https://www.usenix.org/system/files/conference/woot16/woot16-paper-blackthorne_update.pdf)

### Botnets

* [Case study of the miner botnet](http://pnx.tf/files/2012_cycon-official_miner_plohmann_padilla.pdf)
* [Analysis of a Romanian Botnet](http://www.politoinc.com/2015/04/analysis-of-a-romanian-botnet/)

  * Going from first sighting in logs to tracing attackers to their C2 IRC room

* [A timeline of mobile botnets](https://www.virusbtn.com/virusbulletin/archive/2015/03/vb201503-mobile-botnets)

  * With the recent explosion in smartphone usage, malware authors have
    increasingly focused their attention on mobile devices, leading to a steep
    rise in mobile malware over the past couple of years. In this paper, Ruchna
    Nigam focuses on mobile botnets, drawing up an inventory of types of known
    mobile bot variants.

### C2 Infrastructure

* [Dead RATs: Exploiting malware C2 servers](https://samvartaka.github.io/exploitation/2016/06/03/dead-rats-exploiting-malware)
* [Hiding in Plain Sight: Advances in malware covert communication channels - BH2015 Pierre-Marc Bureau, Christian Dietrich](https://www.blackhat.com/docs/eu-15/materials/eu-15-Bureau-Hiding-In-Plain-Sight-Advances-In-Malware-Covert-Communication-Channels-wp.pdf)

### Dynamic Analysis

* [Unicorn VS. Malware](https://r3v3rs3r.wordpress.com/2015/12/12/unicorn-vs-malware/)
* [Dynamic Anti-Emulation using Blackbox Analysis by Second Part To Hell](http://spth.virii.lu/dynamic_anti_emulation.txt)

### Tools

* [DRAKVUF](https://tklengyel.github.io/drakvuf/)

  * DRAKVUF is an agentless dynamic malware analysis system built on Xen,
    LibVMI, Volatility and Rekall. It allows for in-depth execution tracing of
    malware samples and extracting deleted files from memory, all without having
    to install any special software within the virtual machine used for
    analysis.
  * [Code](https://github.com/tklengyel/drakvuf)

* [Zero Wine](http://zerowine.sourceforge.net/)

  * Zero wine is an open source (GPL v2) research project to dynamically analyze
    the behavior of malware. Zero wine just runs the malware using WINE in a
    safe virtual sandbox (in an isolated environment) collecting information
    about the APIs called by the program.

* [Honeyagent](https://bitbucket.org/fkie_cd_dare/honeyagent)

  * HoneyAgent is a Java agent library that creates a Sandbox for Java
    applications and applets. Therefore, it uses the JVMTI as well as the JNI to
    intercept class loading and function calls. During runtime HoneyAgent traces
    function calls from the analysed application. It is displayed which class
    calles which function with which parameters. Reflected function calls are
    translated to the origin function names for simpler reading.

* [Pybox](https://bitbucket.org/daniel_plohmann/pybox/)

  * Auser-level framework for monitoring processes
  * [Research paper on it](https://eldorado.tu-dortmund.de/bitstream/2003/27336/1/BookOfAbstracts_Spring5_2010.pdf)

* [INetSim](http://www.inetsim.org/)

  * INetSim is a software suite for simulating common internet services in a lab
    environment, e.g. for analyzing the network behaviour of unknown malware
    samples.

* [Regshot](http://sourceforge.net/projects/regshot/)

  * Regshot is an open-source (LGPL) registry compare utility that allows you to
    quickly take a snapshot of your registry and then compare it with a second
    one - done after doing system changes or installing a new software product.

* [Mandiant ApateDNS](https://www.mandiant.com/resources/download/research-tool-mandiant-apatedns)

  * Mandiant ApateDNS is a tool for controlling DNS responses though an easy to
    use GUI. As a phony DNS server, Mandiant ApateDNS spoofs DNS responses to a
    user-specified IP address by listening on UDP port 53 on the local machine.
    Mandiant ApateDNS also automatically sets the local DNS to localhost. Upon
    exiting the tool, it sets back the original local DNS settings.

* [Malcom - Malware Communication Analyzer](https://github.com/tomchop/malcom)

  * Malcom is a tool designed to analyze a system's network communication using
    graphical representations of network traffic, and cross-reference them with
    known malware sources. This comes handy when analyzing how certain malware
    species try to communicate with the outside world.

* [BasicHook](https://github.com/MalwareTech/BasicHook)

  * x86 Inline hooking engine (using trampolines)

* Claimsman

  * Claimsman logs all file handle creation on Windows systems, and logs to both
    a local file and centralized log management system.

* [WinMerge](http://winmerge.org/)

  * WinMerge is an Open Source differencing and merging tool for Windows.
    WinMerge can compare both folders and files, presenting differences in a
    visual text format that is easy to understand and handle.

* [API Monitor](http://www.rohitab.com/apimonitor)

  * API Monitor is a free software that lets you monitor and control API calls
    made by applications and services. Its a powerful tool for seeing how
    applications and services work or for tracking down problems that you have
    in your own applications.

* [SpyStudio](http://www.nektra.com/products/spystudio-api-monitor/)

  * SpyStudio shows and interprets calls, displaying the results in a structured
    way which is easy for any IT professional to understand. SpyStudio can show
    registry keys and files that an application uses, COM objects and Windows
    the application has created, and errors and exceptions.

* [Microsoft Message Analyzer](http://www.microsoft.com/en-us/download/details.aspx?id=40308)

  * Microsoft Message Analyzer is a new tool for capturing, displaying, and
    analyzing protocol messaging traffic and other system messages. Message
    Analyzer also enables you to import, aggregate, and analyze data from log
    and trace files. It is the successor to Microsoft Network Monitor 3.4 and a
    key component in the Protocol Engineering Framework (PEF) that was created
    by Microsoft for the improvement of protocol design, development,
    documentation, testing, and support. With Message Analyzer, you can choose
    to capture data live or load archived message collections from multiple data
    sources simultaneously.

* [PyTrigger: A System to Trigger & Extract User-Activated Malware Behavior](http://cs.gmu.edu/~astavrou/research/PyTrigger_ARES2013.pdf)

  * Abstract: PyTrigger analyzes the system trace using a combination of
    multiple states and behavior differencing to accurately extract the malware
    behavior and user triggered behavior from the complete system trace log. We
    present the algorithms, architecture and evaluate the PyTrigger prototype
    using 3994 real malware samples. Results and analysis are presented showing
    PyTrigger extracts additional behavior in 21% of the samples.

### Embedded

* [Analyzing Malware for Embedded Devices: TheMoon Worm](http://w00tsec.blogspot.com/2014/02/analyzing-malware-for-embedded-devices.html)

### Exploit Kits

* [How exploit packs are concealed in a Flash object](https://securelist.com/analysis/publications/69727/how-exploit-packs-are-concealed-in-a-flash-object/?utm_content=buffer5de59&utm_medium=social&utm_source=twitter.com&utm_campaign=buffer)
* [RIG Exploit Kit Writeup](https://www.trustwave.com/Resources/SpiderLabs-Blog/RIG-Exploit-Kit-%E2%80%93-Diving-Deeper-into-the-Infrastructure/)
* [The Economics of Exploit Kits & E-Crime](http://www.irongeek.com/i.php?page=videos/bsidescolumbus2016/offense03-the-economics-of-exploit-kits-e-crime-adam-hogan)

  * I will discuss how the market for exploit kits has been changing, in
    techniques, marketing and prices. I argue that the competitiveness between
    exploit kits shows a maturing market, but will leverage economic theory to
    demonstrate the limits to which that market will continue to mature. This
    should allow us to understand how exploit kits affect (and are affected by)
    the rest of the greater market for hacker services, from malware (as an
    input) to nation-state level attacks (e.g. trickle down from Hacking Team).
    I hope to provide a better understanding of how exploit kits work and how
    their sold as well as how this market can teach us about the rational choice
    to engage in criminal activity and how we might dissuade them.

### Hashing

* [binwally](https://github.com/bmaia/binwally)
* [Binary and Directory tree comparison tool using the Fuzzy Hashing concept (ssdeep)](http://w00tsec.blogspot.com/2013/12/binwally-directory-tree-diff-tool-using.html)
* [Ssdeep](http://ssdeep.sourceforge.net/)
  * static malware comparison tool - ssdeep is a program for computing context
    triggered piecewise hashes (CTPH). Also called fuzzy hashes, CTPH can match
    inputs that have homologies. Such inputs have sequences of identical bytes
    in the same order, although bytes in between these sequences may be
    different in both content and length.

### iOS

### General Analysis

* [PortEX: Robust static anaylsis of Portable Executable Malware](https://evilzone.org/reverse-engineering/%28pdf%29-robust-static-analysis-of-portable-executable-malware/)

### General

* [Malvertising: Under The Hood by Chris Boyd - BSides Manchester2017](https://www.youtube.com/watch?v=VESvOsr91_M&index=1&list=PLcgqQkap1lNrOBNCXqpPqpPAqckxv0XhP)

### Hunting Down Malware

* [License to Kill: Malware Hunting with the Sysinternals Tools](https://channel9.msdn.com/Events/TechEd/NorthAmerica/2013/ATC-B308)

### Mac

* [Writing Bad @$$ Malware for OS X - Patrick Wardle](https://www.blackhat.com/docs/us-15/materials/us-15-Wardle-Writing-Bad-A-Malware-For-OS-X.pdf)
* [Offensive Malware Analysis: Dissecting OSX FruitFly - Patrick Wardle - DEF CON 25](https://www.youtube.com/watch?v=q7VZtCUphgg)

  * FruitFly, the first OS X/macOS malware of 2017, is a rather intriguing
    specimen. Selectively targeting biomedical research institutions, it is
    thought to have flown under the radar for many years. In this talk, we'll
    focus on the 'B' variant of FruitFly that even now, is only detected by a
    handful of security products. We'll begin by analyzing the malware's
    dropper, an obfuscated perl script. As this language is rather archaic and
    uncommon in malware droppers, we'll discuss some debugging techniques and
    fully deconstruct the script.

* [I got 99 Problems, but Little Snitch ain’t one! - Defcon2016](https://speakerdeck.com/patrickwardle/defcon-2016-i-got-99-problems-but-little-snitch-aint-one)

### Malware Repos

* [The Zoo](https://github.com/ytisf/theZoo)

  * A repository of LIVE malwares for your own joy and pleasure

* [Mobile Malware dumps - Contagio](http://contagiominidump.blogspot.ca/)
* [Ragpicker - Malware Crawler](https://code.google.com/p/malware-crawler/)

  * Ragpicker is a Plugin based malware crawler with pre-analysis and reporting
    functionalities. Use this tool if you are testing antivirus products,
    collecting malware for another analyzer/zoo. Contagio/Contagio mobile

* [Equation Group Malware Samples - ContagioDump](http://contagiodump.blogspot.com/2015/02/equation-samples-from-kaspersky-report.html)
* [Objective-See Mac Malware Repo](https://objective-see.com/malware.html)

### Obfuscation

* [Data Obfuscation: Now you see me... Now you don't...](http://malwageddon.blogspot.com/2015/03/data-obfuscation-now-you-see-me-now-you.html)

  * This blog post shows how malware authors use Adobe Flash files to hide their
    creations' 'sensitive' data. I'll be using 2 recent Neutrino EK and 1
    FlashPack malvertising samples to demonstrate it. In the case of Neutrino EK
    our goal will be extraction and decryption of its configuration file and in
    the malvertising case we'll be after the initial payload URL + exploit
    shellcode.

### Office Documents

* [Loffice - Analyzing malicious documents using WinDbg](https://thembits.blogspot.com/2016/06/loffice-analyzing-malicious-documents.html)

### Online Checkers

* [VirusTotal Mining](http://blog.9bplus.com/wp-content/uploads/2014/08/VirusTotal-Mining.pdf)
* [Malice](https://github.com/maliceio/malice)

  * Malice's mission is to be a free open source version of VirusTotal that
    anyone can use at any scale from an independent researcher to a fortune 500
    company.

* [Wepawet](https://wepawet.iseclab.org/)

  * Wepawet is a free service, for non-commercial organizations, to detect and
    analyze web-based threats. It currently handles Flash, JavaScript, and PDF
    files

* [IRMA - Incident Response & Malware Analysis](http://irma.quarkslab.com/index.html)

  * IRMA intends to be an open-source platform designed to help identifying and
    analyzing malicious files. However, today's defense is not only about
    learning about a file, but it is also getting a fine overview of the
    incident you dealt with: where / when a malicious file has been seen, who
    submitted a hash, where a hash has been noticed, which anti-virus detects
    it, ... An important value with IRMA comes from you keep control over where
    goes / who gets your data. Once you install IRMA on your network, your data
    stays on your network. Each submitted files is analyzed in various ways. For
    now, we focus our efforts on multiple anti-virus engines, but we are working
    on other "probes" (feel free to submit your own).

### (Un)Packers/Encoders

* --> See 'Packers' section under 'Writeups' in RE
* [Corkami - Packers](https://corkami.googlecode.com/files/packers.pdf)

  * Beautiful.

* [Stack Overflow RE -What are the different types of packers?](https://reverseengineering.stackexchange.com/questions/1779/what-are-the-different-types-of-packers)
* [packer-breaker](http://www.sysreveal.com/category/packerbreaker/)

  * Unpacker for a variety of packing tools.

* [One packer to rule them all: Empirical identification, comparison and circumvention of current Antivirus detection techniques](http://www.arneswinnen.net/wp-content/uploads/2014/08/)
* [Deep dive into a custom malware packer](http://resources.infosecinstitute.com/deep-dive-into-a-custom-malware-packer/)
* [Manually unpacking a Morphine-packed DLL with OllyDbg](http://www.joestewart.org/morphine-dll/)
* [Paper on Manual unpacking of UPX packed executable using Ollydbg and Importrec](http://www.iosrjournals.org/iosr-jce/papers/Vol16-issue1/Version-1/L016117177.pdf)
* [A study of the packer problem and its solutions](https://link.springer.com/chapter/10.1007/978-3-540-87403-4_6)
* [Packer Analysis Report - Debugging and unpacking the NsPack 3.4 and 3.7 packer](https://www.sans.org/reading-room/whitepapers/malicious/packer-analysis-report-debugging-unpacking-nspack-34-37-packer-33428)

  * WP-us-14-Mesbahi-Swinnen-One-packer-to-rule-them-all-Empirical-identification-comparison-and-circumvention-of-current-Antivirus-detection-techniques.pdf)

* [Duping the machine: malware strategies, post Sandbox detection](https://www.virusbtn.com/pdf/conference_slides/2014/Wyke-VB2014.pdf)
* [Locreate: An Anagram for Relocate ](http://uninformed.org/?v=all&a=30&t=sumry)

  * This paper presents a proof of concept executable packer that does not use
    any custom code to unpack binaries at execution time. This is different from
    typical packers which generally rely on packed executables containing code
    that is used to perform the inverse of the packing operation at runtime.
    Instead of depending on custom code, the technique described in this paper
    uses documented behavior of the dynamic loader as a mechanism for performing
    the unpacking operation. This difference can make binaries packed using this
    technique more difficult to signature and analyze, but only when presented
    to an untrained eye. The description of this technique is meant to be an
    example of a fun thought exercise and not as some sort of revolutionary
    packer. In fact, it's been used in the virus world many years prior to this
    paper.

* [Implementing a Custom X86 Encoder](http://uninformed.org/?v=all&a=25&t=sumry)

  * This paper describes the process of implementing a custom encoder for the
    x86 architecture. To help set the stage, the McAfee Subscription Manager
    ActiveX control vulnerability, which was discovered by eEye, will be used as
    an example of a vulnerability that requires the implementation of a custom
    encoder. In particular, this vulnerability does not permit the use of
    uppercase characters. To help make things more interesting, the encoder
    described in this paper will also avoid all characters above 0x7f. This will
    make the encoder both UTF-8 safe and tolower safe.

* [Using dual-mappings to evade automated unpackers ](http://uninformed.org/?v=all&a=44&t=sumry)

  * Automated unpackers such as Renovo, Saffron, and Pandora's Bochs attempt to
    dynamically unpack executables by detecting the execution of code from
    regions of virtual memory that have been written to. While this is an
    elegant method of detecting dynamic code execution, it is possible to evade
    these unpackers by dual-mapping physical pages to two distinct virtual
    address regions where one region is used as an editable mapping and the
    second region is used as an executable mapping. In this way, the editable
    mapping is written to during the unpacking process and the executable
    mapping is used to execute the unpacked code dynamically. This effectively
    evades automated unpackers which rely on detecting the execution of code
    from virtual addresses that have been written to.

* [Unpacking with OllyBonE](http://www.joestewart.org/ollybone/tutorial.html)

  * This is a brief tutorial giving the basic steps to unpack code using the
    OllyBonE plugin.

### Persistence

* [Poweliks: the persistent malware without a file](https://blog.gdatasoftware.com/blog/article/poweliks-the-persistent-malware-without-a-file.html)
* [Temporal Persistence with bitsadmin and schtasks](http://0xthem.blogspot.com/2014/03/t-emporal-persistence-with-and-schtasks.html)
* [Many ways of malware persistence (that you were always afraid to ask) ](http://jumpespjump.blogspot.com/2015/05/many-ways-of-malware-persistence-that.html)

### Static Analysis Tools

* [Pyew](https://code.google.com/p/pyew/)

  * Pyew is a (command line) python tool to analyse malware. It does have
    support for hexadecimal viewing, disassembly (Intel 16, 32 and 64 bits), PE
    and ELF file formats (it performs code analysis and let you write scripts
    using an API to perform many types of analysis), follows direct call/jmp
    instructions in the interactive command line, displays function names and
    string data references; supports OLE2 format, PDF format and more. It also
    supports plugins to add more features to the tool.

* [Manalyze - static analyzer for PE files](https://github.com/JusticeRage/Manalyze)

  * Manalyze was written in C++ for Windows and Linux and is released under the
    terms of the GPLv3 license. It is a robust parser for PE files with a
    flexible plugin architecture which allows users to statically analyze files
    in-depth.

* [yalda - Gita Ziabari](https://github.com/fideliscyber/yalda)

  * The tool is designed to analyze the given files and extract malicious data
    out of the files.

* [Presentation](https://www.youtube.com/watch?v=OPRqgEZXWOE)
* [Dependency Walker](http://www.dependencywalker.com/)

  * Dependency Walker is a free utility that scans any 32-bit or 64-bit Windows
    module (exe, dll, ocx, sys, etc.) and builds a hierarchical tree diagram of
    all dependent modules. For each module found, it lists all the functions
    that are exported by that module, and which of those functions are actually
    being called by other modules. Another view displays the minimum set of
    required files, along with detailed information about each file including a
    full path to the file, base address, version numbers, machine type, debug
    information, and more.

### Techniques

* [BG00 Injection on Steroids Code less Code Injections and 0 Day Techniques Paul Schofield Udi Yavo](https://www.youtube.com/watch?v=0BAaAM2wD4s)
* [[Slides] Injection on Steroids: Code-less Code Injections and 0-Day Techniques](https://breakingmalware.com/injection-techniques/code-less-code-injections-and-0-day-techniques/)
* [Amoco - Static binary analysis tool](https://github.com/bdcht/amoco)

  * Amoco is a python package dedicated to the (static) analysis of binaries.

* [Code Injection Techniques -2013](http://resources.infosecinstitute.com/code-injection-techniques/)

### Virtual Machines

* [antivmdetection](https://github.com/nsmfoo/antivmdetection)

  * Script to create templates to use with VirtualBox to make vm detection
    harder.

* [Breaking the Sandbox - Sudeep Singh](http://www.exploit-db.com/wp-content/themes/exploit/docs/34591.pdf)

  * Abstract: In this paper, I would like to discuss various existing and
    interesting techniques which are used to evade the detection of a virus in
    Sandbox. We will also look at ways a sandbox can be hardened to prevent such
    evasion.

* [On the Cutting Edge: Thwarting Virtual Machine Detection](http://handlers.sans.org/tliston/ThwartingVMDetection_Liston_Skoudis.pdf)
* [Paranoid Fish](https://github.com/a0rtega/pafish)

  * Pafish is a demo tool that performs some anti(debugger/VM/sandbox) tricks.
    Most of them are often used by malware to avoid debugging and dynamic
    analysis. The project is open source, you can read the code of all
    anti-analysis checks. You can also download the compiled executable (or
    compile it by yourself) and reverse engineer it, which is quite recommended.

* [rdtsc x86 instruction to detect virtual machines](http://blog.badtrace.com/post/rdtsc-x86-instruction-to-detect-vms/)
* [Win64/Vabushky - The Great Code Heist](http://www.malwaretech.com/2013/09/win64vabushky-great-code-heist.html)
* [Scientific but Not Academical Overview of Malware Anti-Debugging, Anti-Disassembly and Anti- VM Technologies](http://research.dissect.pe/docs/blackhat2012-paper.pdf)

  * This talk catalogs the common evasion techniques malware authors employ,
    applying over 50 different static detections, combined with a few dynamic
    ones for completeness. We validate our catalog by running these detections
    against a database of 4 million samples (the system is constantly running
    and the numbers will be updated for the presentation), enabling us to
    present an analysis on the real state of evasion techniques in use by
    malware today. The resulting data will help security companies and
    researchers around the world to focus their attention on making their tools
    and processes more efficient to rapidly avoid the malware authors'
    countermeasures.

* [Process Hollowing - Dridex](http://countuponsecurity.com/2015/12/07/malware-analysis-dridex-process-hollowing/)
* [SubVirt: Implementing malware with virtual machines](http://web.eecs.umich.edu/virtual/papers/king06.pdf)

  * We evaluate a new type of malicious software that gains qualitatively more
    control over a system. This new type of malware, which we call a
    virtual-machine based rootkit (VMBR), installs a virtual-machine monitor
    underneath an existing operating system and hoists the original operating
    system into a virtual machine. Virtual-machine based rootkits are hard to
    detect and remove because their state cannot be accessed by soft- ware
    running in the target system. Further, VMBRs support general-purpose
    malicious services by allowing such services to run in a separate operating
    system that is protected from the target system. We evaluate this new threat
    by implementing two proof-of-concept VMBRs. We use our proof-of-concept
    VMBRs to subvert Windows XP and Linux target systems, and we implement four
    example malicious services using the VMBR platform. Last, we use what we
    learn from our proof-of-concept VMBRs to explore ways to defend against this
    new threat. We discuss possible ways to detect and prevent VMBRs, and we
    implement a defense strategy suitable for protecting systems against this
    threat.

* [Modeling Zero Day Malware Spread](https://lqdc.github.io/modeling-zero-day-malware-spread.html)

  * Duping the Machine: malware strategies, post sandbox detection

* [Slide deck presentation](https://www.virusbtn.com/pdf/conference_slides/2014/Wyke-VB2014.pdf)
* [Win32_ComputerSystem class](<https://msdn.microsoft.com/en-us/library/aa394102(v=vs.85).aspx>)
* [Win32_BIOS class](<https://msdn.microsoft.com/en-us/library/aa394077(v=vs.85).aspx>)

### Windows

* [Trojan.Foxy writeup](http://www.cyberesi.com/2011/08/31/trojan-foxy/)

  * Today I will write about a sample that I will refer to as Trojan.Foxy.
    Trojan.Foxy requests and parses .JPG images that contain encoded
    instructions. The encoding algorithm used by this Trojan is loosely based
    off of the Vigenère cipher; however there is a deviation in how the cipher
    is applied.

* [Uroburos](https://blog.gdatasoftware.com/blog/article/uroburos-highly-complex-espionage-software-with-russian-roots.html)

  * `https://www.gdata.de/rdk/dl-en-rp-Uroburos`

* [Thousand ways to backdoor a Windows domain (forest)](http://jumpespjump.blogspot.com/2015/03/thousand-ways-to-backdoor-windows.html)
* [COM Object hijacking: the discreet way of persistence](https://blog.gdatasoftware.com/blog/article/com-object-hijacking-the-discreet-way-of-persistence.html)
* [Nesting doll: unwrapping Vawtrak](https://www.virusbtn.com/virusbulletin/archive/2015/01/vb201501-Vawtrak)
* [Rotten Tomatoes campaign by Sophos](http://www.sophos.com/en-us/medialibrary/PDFs/technical%20papers/sophos-rotten-tomato-campaign.pdf)
* [Full details on CVE-2015-0096 and the failed MS10-046 Stuxnet fix](http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/Full-details-on-CVE-2015-0096-and-the-failed-MS10-046-Stuxnet/ba-p/6718459#.VP9cTDTF-PU)

#### Misc

* [The Backdoor Factory (BDF)](https://github.com/secretsquirrel/the-backdoor-factory)

  * For security professionals and researchers only. The goal of BDF is to patch
    executable binaries with user desired shellcode and continue normal
    execution of the prepatched state.

* [Derbycon Presentation](https://www.youtube.com/watch?v=LjUN9MACaTs)
* [How to Bypass Anti-Virus to Run Mimikatz - **Spoiler, AV still suck, changing strings is helpful**](http://www.blackhillsinfosec.com/?p=5555)
* [peCloak.py - An Experiment in AV Evasion](http://www.securitysift.com/pecloak-py-an-experiment-in-av-evasion/)
* [Making FinFisher Undetectable](https://lqdc.github.io/making-finfisher-undetectable.html)
* [Bypass AV through several basic/effective techniques](http://packetstorm.foofus.com/papers/virus/BypassAVDynamics.pdf)
* [stupid_malware](https://github.com/andrew-morris/stupid_malware)

  * Python malware for pentesters that bypasses most antivirus (signature and
    heuristics) and IPS using sheer stupidity

* [InfectPE](https://github.com/secrary/InfectPE)

  * Using this tool you can inject x-code/shellcode into PE file. InjectPE works
    only with 32-bit executable files.

* [Frida](http://www.frida.re/docs/home/)

  * Inject JS into native apps

* [Maltrail](https://github.com/stamparm/maltrail)

  * Maltrail is a malicious traffic detection system, utilizing publicly
    available (black)lists containing malicious and/or generally suspicious
    trails, along with static trails compiled from various AV reports and custom
    user defined lists, where trail can be anything from domain name (e.g.
    zvpprsensinaix.com for Banjori malware), URL (e.g.
    http://109.162.38.120/harsh02.exe for known malicious executable), IP
    address (e.g. 185.130.5.231 for known attacker) or HTTP User-Agent header
    value (e.g. sqlmap for automatic SQL injection and database takeover tool).
    Also, it uses (optional) advanced heuristic mechanisms that can help in
    discovery of unknown threats (e.g. new malware).

* [PowerLoaderEX](https://github.com/BreakingMalware/PowerLoaderEx)

* [Software Distribution Malware Infection Vector](http://dl.packetstormsecurity.net/papers/general/Software.Distribution.Malware.Infection.Vector.pdf)

  * In this paper we present an efficient mechanism as well as the corresponding
    reference implementation for on- the-fly infecting of executable code with
    malicious soft- ware. Our algorithm deploys virus infection routines and
    network redirection attacks, without requiring to modify the application
    itself. This allows to even infect executa- bles with a embedded signature
    when the signature is not automatically verified before execution. We
    briefly dis- cuss also countermeasures such as secure channels, code
    authentication as well as trusted virtualization that en- ables the
    isolation of untrusted downloads from other ap- plication running in trusted
    domains or compartments.

* [Statistical Structures: Fingerprinting Malware for Classification and Analysis - Daniel Bilar](https://www.blackhat.com/presentations/bh-usa-06/BH-US-06-Bilar.pdf)
* [Malware Guard Extension: Using SGX to Conceal Cache Attacks](https://arxiv.org/abs/1702.08719)

  * In this paper, we demonstrate fine-grained software-based side-channel
    attacks from a malicious SGX enclave targeting co-located enclaves. Our
    attack is the first malware running on real SGX hardware, abusing SGX
    protection features to conceal itself. Furthermore, we demonstrate our
    attack both in a native environment and across multiple Docker containers.
    We perform a Prime+Probe cache side-channel attack on a co-located SGX
    enclave running an up-to-date RSA implementation that uses a constant-time
    multiplication primitive. The attack works although in SGX enclaves there
    are no timers, no large pages, no physical addresses, and no shared memory.
    In a semi-synchronous attack, we extract 96% of an RSA private key from a
    single trace. We extract the full RSA private key in an automated attack
    from 11 traces within 5 minutes.
