##Malware

TOC
* [Tutorials](#tutorial)
* [Writeups](#writeup)
* [Malware Repositories](#repository)
* [Mobile}(#mobile)
* [Anti-VM/Detecting VMs](#antivm)
* [Tools](#tools)
* [Static Analysis](#static)
* [Dynamic Analysis](#dynamic)
* [AV Evasion/Encoders/Packers](#packers]
* [Papers](#papers)
* [Talks](#talks)
* [Other](#other)




##### Sort

http://securityxploded.com/malware-analysis-training-reference.php

http://www.malwarearchaeology.com/mmf/

https://motherboard.vice.com/read/preserving-the-ancient-art-of-getting-pwned

http://www.exposedbotnets.com/?m=0

[malboxes](https://github.com/GoSecure/malboxes)
f* Builds malware analysis Windows VMs so that you don't have to.


[PlugBot-C2C](https://github.com/redteamsecurity/PlugBot-C2C)
* This is the Command & Control component of the PlugBot project

[hiddentear](https://github.com/goliate/hidden-tear)
* It's a ransomware-like file crypter sample which can be modified for specific purposes.

https://brycampbell.co.uk/new-blog/
https://archive.is/Nol3S

[Hiding in Plain Sight: Advances in malware covert communication channels - BH2015 Pierre-Marc Bureau, Christian Dietrich](https://www.blackhat.com/docs/eu-15/materials/eu-15-Bureau-Hiding-In-Plain-Sight-Advances-In-Malware-Covert-Communication-Channels-wp.pdf)

[rVMI - A New Paradigm For Full System Analysis](https://github.com/fireeye/rvmi)
* rVMI is a debugger on steroids. It leverages Virtual Machine Introspection (VMI) and memory forensics to provide full system analysis. This means that an analyst can inspect userspace processes, kernel drivers, and preboot environments in a single tool.  It was specifially designed for interactive dynamic malware analysis. rVMI isolates itself from the malware by placing its interactive debugging environment out of the virtual machine (VM) onto the hypervisor-level. Through the use of VMI the analyst still has full control of the VM, which allows her to pause the VM at any point in time and to use typical debugging features such as breakpoints and watchpoints. In addtion, rVMI provides access to the entire Rekall feature set, which enables an analyst to inspect the kernel and its data structures with ease.


##### END Sort






##### To Do
* Sort Tools
* Clean up/organize




### General

[Awesome Malware Analysis - Github Awesome List series](https://github.com/rshipp/awesome-malware-analysis)




### <a name="tutorial">Tutorials</a>


[Reverse Engineering Malware 101 Material - Malware Unicorn](https://securedorg.github.io/RE101/)

[Malware Analysis Tutorials: a Reverse Engineering Approach - Dr Xiang Fu](https://fumalwareanalysis.blogspot.com/p/malware-analysis-tutorials-reverse.html)

[Malware Analysis Tutorials: a Reverse Engineering Approach](http://fumalwareanalysis.blogspot.com/p/malware-analysis-tutorials-reverse.html)

[Creating a Malware Sandbox in Seconds with Noriben.](http://www.ghettoforensics.com/2016/01/creating-malware-sandbox-in-seconds.html?m=1)

[Malware analyis noob to ninja 60min presentation slides](http://www.slideshare.net/grecsl/malware-analysis-101-n00b-to-ninja-in-60-minutes-at-cactuscon-on-april-4-2014)

[Automating Removal of JS Obfuscators](http://www.contextis.com/resources/blog/automating-removal-java-obfuscation/)
* In this post we detail a method to improve analysis of Java code for a particular obfuscator, we document the process that was followed and demonstrate the results of automating our method. Obscurity will not stop an attacker and once the method is known, methodology can be developed to automate the process. 

[Malware Analysis 101 - N00b to Ninja in 60 Minutes at CactusCon on April 4, 2014](https://www.slideshare.net/grecsl/malware-analysis-101-n00b-to-ninja-in-60-minutes-at-cactuscon-on-april-4-2014)

[DIY Android Malware Analysis with OBAD](http://securityintelligence.com/diy-android-malware-analysis-taking-apart-obad-part-1/)

[Cuckoo Sandbox Hardening(2013)](http://0xmalware.blogspot.com/2013/10/cuckoo-sandbox-hardening-virtualbox.html)

[Building a Home Lab to Become a Malware Hunter - A Beginner’s Guide](https://www.alienvault.com/blogs/security-essentials/building-a-home-lab-to-become-a-malware-hunter-a-beginners-guide)

[A Guide to Malware Binary Reconstruction](https://github.com/0xAX/linux-insides/blob/master/Misc/contribute.md)
[ ZeroAccess Malware - Part 1 De-Obfuscating and Reversing the User-Mode Agent Dropper](http://resources.infosecinstitute.com/step-by-step-tutorial-on-reverse-engineering-malware-the-zeroaccessmaxsmiscer-crimeware-rootkit/)









### <a name="writeup">Writeups</a>

[Escaping The Avast Sandbox Using A Single IOCTL](https://www.nettitude.co.uk/escaping-avast-sandbox-using-single-ioctl-cve-2016-4025)

[Dead RATs: Exploiting malware C2 servers](https://samvartaka.github.io/exploitation/2016/06/03/dead-rats-exploiting-malware)

[Decoding ZeuS disguised as an .RTF File](http://phishme.com/decoding-zeus-disguised-as-an-rtf-file/)
* Excellent step by step writeup


[Hacking Team Writeup](https://citizenlab.org/2014/06/backdoor-hacking-teams-tradecraft-android-implant/)

[FinFisher Malware Dropper Analysis](https://www.codeandsec.com/FinFisher-Malware-Dropper-Analysis)

[How To Dissect Android Flappy Bird Malware](http://securehoney.net/blog/how-to-dissect-android-flappy-bird-malware.html)

[Analyzing unknown malware blogpost series](http://thegoldenmessenger.blogspot.com/

[Android/Beita.A malware analysis](http://www.jamesejr.com/android-beita-malware-analysis/)

[Trojan.Foxy writeup](http://www.cyberesi.com/2011/08/31/trojan-foxy/?ModPagespeed=noscrip
* Today I will write about a sample that I will refer to as Trojan.Foxy. Trojan.Foxy requests and parses .JPG images that contain encoded instructions. The encoding algorithm used by this Trojan is loosely based off of the Vigenère cipher; however there is a deviation in how the cipher is applied.

[Uroburos](https://blog.gdatasoftware.com/blog/article/uroburos-highly-complex-espionage-software-with-russian-roots.html)
* https://www.gdata.de/rdk/dl-en-rp-Uroburos

[Data Obfuscation: Now you see me... Now you don't...](http://malwageddon.blogspot.com/2015/03/data-obfuscation-now-you-see-me-now-you.html)
* This blog post shows how malware authors use Adobe Flash files to hide their creations' 'sensitive' data. I'll be using 2 recent Neutrino EK and 1 FlashPack malvertising samples to demonstrate it. In the case of Neutrino EK our goal will be extraction and decryption of its configuration file and in the malvertising case we'll be after the initial payload URL + exploit shellcode.

[Rotten Tomatoes campaign by Sophos](http://www.sophos.com/en-us/medialibrary/PDFs/technical%20papers/sophos-rotten-tomato-campaign.pdf)

[Full details on CVE-2015-0096 and the failed MS10-046 Stuxnet fix](http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/Full-details-on-CVE-2015-0096-and-the-failed-MS10-046-Stuxnet/ba-p/6718459#.VP9cTDTF-PU)

[ How exploit packs are concealed in a Flash object](https://securelist.com/analysis/publications/69727/how-exploit-packs-are-concealed-in-a-flash-object/?utm_content=buffer5de59&utm_medium=social&utm_source=twitter.com&utm_campaign=buffer)

[North Korean Malware Writeup](https://www.codeandsec.com/Supreme-Leaders-Not-That-Supreme-Malwares)

[Regin Malware writeup by F-Secure](https://www.f-secure.com/weblog/archives/00002774.html)

[Case study of the miner botnet](http://pnx.tf/files/2012_cycon-official_miner_plohmann_padilla.pdf)

[How ESEA detects cheat software in its online gaming league - Let's get physical!](http://everdox.blogspot.com/2015/02/how-esea-detects-cheat-software-in-its.html)
* Before we dig in, this post should not be construed as an attack on ESEA, anti-cheat software, or fair gaming in general. It is simply an analysis thereof, detailing what the ESEA driver does on your machine. Although analysis will make attack vectors clear and obvious, no code or detailed explanation of how to leverage these points will be given.

[Unpacking with OllyBonE](http://www.joestewart.org/ollybone/tutorial.html)
* This is a brief tutorial giving the basic steps to unpack code using the OllyBonE plugin.


[Thousand ways to backdoor a Windows domain (forest)](http://jumpespjump.blogspot.com/2015/03/thousand-ways-to-backdoor-windows.html)

[COM Object hijacking: the discreet way of persistence](https://blog.gdatasoftware.com/blog/article/com-object-hijacking-the-discreet-way-of-persistence.html)

[Poweliks: the persistent malware without a file](https://blog.gdatasoftware.com/blog/article/poweliks-the-persistent-malware-without-a-file.html)

[Temporal Persistence with bitsadmin and schtasks](http://0xthem.blogspot.com/2014/03/t-emporal-persistence-with-and-schtasks.html)

[License to Kill: Malware Hunting with the Sysinternals Tools](https://channel9.msdn.com/Events/TechEd/NorthAmerica/2013/ATC-B308)

[Many ways of malware persistence (that you were always afraid to ask) ](http://jumpespjump.blogspot.com/2015/05/many-ways-of-malware-persistence-that.html)

[Unicorn VS. Malware](https://r3v3rs3r.wordpress.com/2015/12/12/unicorn-vs-malware/)

[Nesting doll: unwrapping Vawtrak](https://www.virusbtn.com/virusbulletin/archive/2015/01/vb201501-Vawtrak)

[ Analyzing Malware for Embedded Devices: TheMoon Worm ](http://w00tsec.blogspot.com/2014/02/analyzing-malware-for-embedded-devices.html)

[Analysis of a Romanian Botnet](http://www.politoinc.com/2015/04/analysis-of-a-romanian-botnet/)
* Going from first sighting in logs to tracing attackers to their C2 IRC room

[Dynamic Anti-Emulation using Blackbox Analysis by Second Part To Hell](http://spth.virii.lu/dynamic_anti_emulation.txt)




### <a name="repository">Malware Repositories/Collecting & Obtaining Malware</a>
[The Zoo](https://github.com/ytisf/theZoo)
* A repository of LIVE malwares for your own joy and pleasure

[Mobile Malware dumps - Contagio](http://contagiominidump.blogspot.ca/)

Contagio/Contagio mobile

[Ragpicker - Malware Crawler](https://code.google.com/p/malware-crawler/)
* Ragpicker is a Plugin based malware crawler with pre-analysis and reporting functionalities. Use this tool if you are testing antivirus products, collecting malware for another analyzer/zoo.













### <a name="mobile">Mobile Malware(General):</a>
[A timeline of mobile botnets](https://www.virusbtn.com/virusbulletin/archive/2015/03/vb201503-mobile-botnets) 
* With the recent explosion in smartphone usage, malware authors have increasingly focused their attention on mobile devices, leading to a steep rise in mobile malware over the past couple of years. In this paper, Ruchna Nigam focuses on mobile botnets, drawing up an inventory of types of known mobile bot variants.

[Android Sandbox V1](http://androidsandbox.net/)
* Automated Malware Analysis

[Obfuscation in Android Malware and how to fight back](https://www.virusbtn.com/virusbulletin/archive/2014/07/vb201407-Android-obfuscation)

[Android/Beita.A malware analysis](http://www.jamesejr.com/android-beita-malware-analysis/)

[Keep Calm and (Don’t) Enable Macros: A New Threat Actor Targets UAE Dissidents](https://citizenlab.org/2016/05/stealth-falcon/)

[Cuckoo-Droid](https://github.com/i[danr1986/cuckoo-droid/blob/master/README.md)
* CuckooDroid is an extension of Cuckoo Sandbox the Open Source software for automating analysis of suspicious files, CuckooDroid brigs to cuckoo the capabilities of execution and analysis of android application.






### Android obfuscators
[ProGuard](http://proguard.sourceforge.net/)

[DexGuard](http://www.saikoa.com/dexguard)

[Obfuscation in Android malware, and how to fight back](https://www.virusbtn.com/virusbulletin/archive/2014/07/vb201407-Android-obfuscation)









### Android De-obfuscators
[De-hoser](https://github.com/strazzere/dehoser)
* Unpacker for the HoseDex2Jar APK Protection which packs the original file inside the dex header

[hidex](https://github.com/cryptax/dextools/tree/master/hidex)
* hides or reveals a given method in a DEX file

[Android Unpacker presented at Defcon 22: Android Hacker Protection Level 0](https://github.com/strazzere/android-unpacker)
* native-unpacker/ - Unpacker for APKProtect/Bangcle/LIAPP/Qihoo Packer that runs natively, no dependency on gdb
* hide-qemu/ - Small hacks for hiding the qemu/debuggers, specifically from APKProtect












### <a name="antivm">Anti-VM/Detecting VMs</a>
* http://msdn.microsoft.com/en-us/library/aa394102%28v=vs.85%29.aspx
* http://msdn.microsoft.com/en-us/library/aa394077%28v=vs.85%29.aspx

 [antivmdetection](https://github.com/nsmfoo/antivmdetection)
* Script to create templates to use with VirtualBox to make vm detection harder.

[Breaking the Sandbox - Sudeep Singh](http://www.exploit-db.com/wp-content/themes/exploit/docs/34591.pdf)
* Abstract: In this paper, I would like to discuss various existing and interesting techniques which are used to evade the detection of a virus in Sandbox. We will also look at ways a sandbox can be hardened to prevent such evasion.

[On the Cutting Edge: Thwarting Virtual Machine Detection](http://handlers.sans.org/tliston/ThwartingVMDetection_Liston_Skoudis.pdf)

[Paranoid Fish](https://github.com/a0rtega/pafish)
* Pafish is a demo tool that performs some anti(debugger/VM/sandbox) tricks. Most of them are often used by malware to avoid debugging and dynamic analysis. The project is open source, you can read the code of all anti-analysis checks. You can also download the compiled executable (or compile it by yourself) and reverse engineer it, which is quite recommended.

[rdtsc x86 instruction to detect virtual machines](http://blog.badtrace.com/post/rdtsc-x86-instruction-to-detect-vms/)

[Win64/Vabushky - The Great Code Heist](http://www.malwaretech.com/2013/09/win64vabushky-great-code-heist.html)
[Scientific but Not Academical Overview of Malware Anti-Debugging, Anti-Disassembly and Anti- VM Technologies](http://research.dissect.pe/docs/blackhat2012-paper.pdf)
* This talk catalogs the common evasion techniques malware authors employ, applying over 50 different static detections, combined with a few dynamic ones for completeness. We validate our catalog by running these detections against a database of 4 million samples (the system is constantly running and the numbers will be updated for the presentation), enabling us to present an analysis on the real state of evasion techniques in use by malware today. The resulting data will help security companies and researchers around the world to focus their attention on making their tools and processes more efficient to rapidly avoid the malware authors' countermeasures. 












### <a name="writeup">Malware Campaign Writeups</a>


[Unmasking Careto through Memory Analysis - Andrew Case](http://2014.video.sector.ca/video/110388398)

Stuxnet

Duqu

Flame

Itaduke



[Fanny Malware Writeup](https://securelist.com/blog/research/68787/a-fanny-equation-i-am-your-father-stuxnet/)	

[RIG Exploit Kit Writeup](https://www.trustwave.com/Resources/SpiderLabs-Blog/RIG-Exploit-Kit-%E2%80%93-Diving-Deeper-into-the-Infrastructure/)

[Equation Group Malware Samples - ContagioDump](http://contagiodump.blogspot.com/2015/02/equation-samples-from-kaspersky-report.html)


Operation SMN:
Axiom Threat Actor Group Report
[Executive Summary](http://www.novetta.com/files/9714/1446/8199/Executive_Summary-Final_1.pdf)
[Analysis of Urobouros](https://blog.gdatasoftware.com/blog/article/analysis-of-uroburos-using-windbg.html)










####F inFisher
CodeandSec.com writeup:
[Part 1](https://www.codeandsec.com/FinFisher-Malware-Dropper-Analysis)
[Part 2](https://www.codeandsec.com/FinFisher-Malware-Analysis-Part-2)
[Part 3](https://www.codeandsec.com/FinFisher-Malware-Analysis-Part-3)







#### Finspy
[Hacking FinSpy - a Case Study - Atilla Marosi - [TROOPERS15]](https://www.youtube.com/watch?v=Mb4mfBi06K4)
















### <a name="dynamic">Dynamic Malware Analysis</a>

[Zero Wine](http://zerowine.sourceforge.net/)
* Zero wine is an open source (GPL v2) research project to dynamically analyze the behavior of malware. Zero wine just runs the malware using WINE in a safe virtual sandbox (in an isolated environment) collecting information about the APIs called by the program.

[Honeyagent](https://bitbucket.org/fkie_cd_dare/honeyagent)
* HoneyAgent is a Java agent library that creates a Sandbox for Java applications and applets. Therefore, it uses the JVMTI as well as the JNI to intercept class loading and function calls. During runtime HoneyAgent traces function calls from the analysed application. It is displayed which class calles which function with which parameters. Reflected function calls are translated to the origin function names for simpler reading.

[Pybox](https://bitbucket.org/daniel_plohmann/pybox/)
[Research paper on it](https://eldorado.tu-dortmund.de/bitstream/2003/27336/1/BookOfAbstracts_Spring5_2010.pdf)
* user-level framework for monitoring processes










#### Setting up the Lab

http://www.cybersquared.com/2012/06/malware-analysis-lab-a-fast-and-cost-effective-howto/

[Awesome Guide to building a VM for anonymous Malware Analysis and Reverse Engineering](https://www.codeandsec.com/Building-Ultimate-Anonymous-Malware-Analysis-and-Reverse-Engineering-Machine)






















### <a name="encoder">Encoders/Packers/AV Evasion</a>
Use PEiD to id most packers/etc.


mew
ASPROTECT
UPX
FSG
PESpin

[Stack Overflow RE -What are the different types of packers?](https://reverseengineering.stackexchange.com/questions/1779/what-are-the-different-types-of-packers)

[The Backdoor Factory (BDF)](https://github.com/secretsquirrel/the-backdoor-factory)
* For security professionals and researchers only.  The goal of BDF is to patch executable binaries with user desired shellcode and continue normal execution of the prepatched state. 
* [Derbycon Presentation](https://www.youtube.com/watch?v=LjUN9MACaTs)

[Deep dive into a custom malware packer](http://resources.infosecinstitute.com/deep-dive-into-a-custom-malware-packer/)

[Corkami - Packers](https://corkami.googlecode.com/files/packers.pdf)
* Beautiful.

[Manually unpacking a Morphine-packed DLL with OllyDbg](http://www.joestewart.org/morphine-dll/)

[A study of the packer problem and its solutions](A Study of the Packer Problem and Its Solutions)

[Packer Analysis Report - Debugging and unpacking the NsPack 3.4 and 3.7 packer](https://www.sans.org/reading-room/whitepapers/malicious/packer-analysis-report-debugging-unpacking-nspack-34-37-packer-33428)

[One packer to rule them all: Empirical identification, comparison and circumvention of current Antivirus detection techniques](http://www.arneswinnen.net/wp-content/uploads/2014/08/WP-us-14-Mesbahi-Swinnen-One-packer-to-rule-them-all-Empirical-identification-comparison-and-circumvention-of-current-Antivirus-detection-techniques.pdf)

[Making FinFisher Undetectable](https://lqdc.github.io/making-finfisher-undetectable.html)

[Paper on Manual unpacking of UPX packed executable using Ollydbg and Importrec](http://www.iosrjournals.org/iosr-jce/papers/Vol16-issue1/Version-1/L016117177.pdf)

[How to Bypass Anti-Virus to Run Mimikatz - **Spoiler, AV still suck, changing strings is helpful**](http://www.blackhillsinfosec.com/?p=5555)

[peCloak.py - An Experiment in AV Evasion](http://www.securitysift.com/pecloak-py-an-experiment-in-av-evasion/)

[Implementing a Custom X86 Encoder](http://uninformed.org/?v=all&a=25&t=sumry)
* This paper describes the process of implementing a custom encoder for the x86 architecture. To help set the stage, the McAfee Subscription Manager ActiveX control vulnerability, which was discovered by eEye, will be used as an example of a vulnerability that requires the implementation of a custom encoder. In particular, this vulnerability does not permit the use of uppercase characters. To help make things more interesting, the encoder described in this paper will also avoid all characters above 0x7f. This will make the encoder both UTF-8 safe and tolower safe. 

[Using dual-mappings to evade automated unpackers ](http://uninformed.org/?v=all&a=44&t=sumry)
* Automated unpackers such as Renovo, Saffron, and Pandora's Bochs attempt to dynamically unpack executables by detecting the execution of code from regions of virtual memory that have been written to. While this is an elegant method of detecting dynamic code execution, it is possible to evade these unpackers by dual-mapping physical pages to two distinct virtual address regions where one region is used as an editable mapping and the second region is used as an executable mapping. In this way, the editable mapping is written to during the unpacking process and the executable mapping is used to execute the unpacked code dynamically. This effectively evades automated unpackers which rely on detecting the execution of code from virtual addresses that have been written to.

[Android Packers](http://www.fortiguard.com/uploads/general/Area41Public.pdf)

[Locreate: An Anagram for Relocate ](http://uninformed.org/?v=all&a=30&t=sumry)
* This paper presents a proof of concept executable packer that does not use any custom code to unpack binaries at execution time. This is different from typical packers which generally rely on packed executables containing code that is used to perform the inverse of the packing operation at runtime. Instead of depending on custom code, the technique described in this paper uses documented behavior of the dynamic loader as a mechanism for performing the unpacking operation. This difference can make binaries packed using this technique more difficult to signature and analyze, but only when presented to an untrained eye. The description of this technique is meant to be an example of a fun thought exercise and not as some sort of revolutionary packer. In fact, it's been used in the virus world many years prior to this paper.

[Duping the machine: malware strategies, post Sandbox detection](https://www.virusbtn.com/pdf/conference_slides/2014/Wyke-VB2014.pdf)

[Bypass AV through several basic/effective techniques](http://packetstorm.foofus.com/papers/virus/BypassAVDynamics.pdf)

[Process Hollowing - Dridex](http://countuponsecurity.com/2015/12/07/malware-analysis-dridex-process-hollowing/)
















###  <a name="tools">Tools</a>

[WinMerge](http://winmerge.org/)
* WinMerge is an Open Source differencing and merging tool for Windows. WinMerge can compare both folders and files, presenting differences in a visual text format that is easy to understand and handle.

[Limon - Sandbox for Analyzing Linux Malwares](https://github.com/monnappa22/Limon)

[Pyew](https://code.google.com/p/pyew/)
* Pyew is a (command line) python tool to analyse malware. It does have support for hexadecimal viewing, disassembly (Intel 16, 32 and 64 bits), PE and ELF file formats (it performs code analysis and let you write scripts using an API to perform many types of analysis), follows direct call/jmp instructions in the interactive command line, displays function names and string data references; supports OLE2 format, PDF format and more. It also supports plugins to add more features to the tool.

[Microsoft Message Analyzer](http://www.microsoft.com/en-us/download/details.aspx?id=40308)
* Microsoft Message Analyzer is a new tool for capturing, displaying, and analyzing protocol messaging traffic and other system messages. Message Analyzer also enables you to import, aggregate, and analyze data from log and trace files. It is the successor to Microsoft Network Monitor 3.4 and a key component in the Protocol Engineering Framework (PEF) that was created by Microsoft for the improvement of protocol design, development, documentation, testing, and support. With Message Analyzer, you can choose to capture data live or load archived message collections from multiple data sources simultaneously.

[stupid_malware](https://github.com/andrew-morris/stupid_malware)
* Python malware for pentesters that bypasses most antivirus (signature and heuristics) and IPS using sheer stupidity

[binwally](https://github.com/bmaia/binwally)

[Binary and Directory tree comparison tool using the Fuzzy Hashing concept (ssdeep)](http://w00tsec.blogspot.com/2013/12/binwally-directory-tree-diff-tool-using.html)

[Ssdeep](http://ssdeep.sourceforge.net/)
* static malware comparison tool
* ssdeep is a program for computing context triggered piecewise hashes (CTPH). Also called fuzzy hashes, CTPH can match inputs that have homologies. Such inputs have sequences of identical bytes in the same order, although bytes in between these sequences may be different in both content and length. 

[DRAKVUF](https://tklengyel.github.io/drakvuf/)
* DRAKVUF is an agentless dynamic malware analysis system built on Xen, LibVMI, Volatility and Rekall. It allows for in-depth execution tracing of malware samples and extracting deleted files from memory, all without having to install any special software within the virtual machine used for analysis.

[Code](https://github.com/tklengyel/drakvuf)

[Amoco - Static binary analysis tool](https://github.com/bdcht/amoco)
* Amoco is a python package dedicated to the (static) analysis of binaries.
* Worth a check on the Github

[API Monitor](http://www.rohitab.com/apimonitor)
* API Monitor is a free software that lets you monitor and control API calls made by applications and services. Its a powerful tool for seeing how applications and services work or for tracking down problems that you have in your own applications.

[SpyStudio](http://www.nektra.com/products/spystudio-api-monitor/)
* SpyStudio shows and interprets calls, displaying the results in a structured way which is easy for any IT professional to understand. SpyStudio can show registry keys and files that an application uses, COM objects and Windows the application has created, and errors and exceptions.

[Frida](http://www.frida.re/docs/home/)
* Inject JS into native apps

[Truman](http://www.secureworks.com/cyber-threat-intelligence/tools/truman/)
* Truman can be used to build a "sandnet", a tool for analyzing malware in an environment that is isolated, yet provides a virtual Internet for the malware to interact with. It runs on native hardware, therefore it is not stymied by malware which can detect VMWare and other VMs. The major stumbling block to not using VMs is the difficulty involved with repeatedly imaging machines for re-use. Truman automates this process, leaving the researcher with only minimal work to do in order to get an initial analysis of a piece of malware. Truman consists of a Linux boot image (originally based on Chas Tomlin's Windows Image Using Linux) and a collection of scripts. Also provided is pmodump, a Perl-based tool to reconstruct the virtual memory space of a process from a PhysicalMemory dump. With this tool it is possible to circumvent most packers to perform strings analysis on the dumped malware.

[IRMA - Incident Response & Malware Analysis](http://irma.quarkslab.com/index.html)
* IRMA intends to be an open-source platform designed to help identifying and analyzing malicious files.  However, today's defense is not only about learning about a file, but it is also getting a fine overview of the incident you dealt with: where / when a malicious file has been seen, who submitted a hash, where a hash has been noticed, which anti-virus detects it, ...  An important value with IRMA comes from you keep control over where goes / who gets your data. Once you install IRMA on your network, your data stays on your network.  Each submitted files is analyzed in various ways. For now, we focus our efforts on multiple anti-virus engines, but we are working on other "probes" (feel free to submit your own).

[Maltrail](https://github.com/stamparm/maltrail#architecture)
* Maltrail is a malicious traffic detection system, utilizing publicly available (black)lists containing malicious and/or generally suspicious trails, along with static trails compiled from various AV reports and custom user defined lists, where trail can be anything from domain name (e.g. zvpprsensinaix.com for Banjori malware), URL (e.g. http://109.162.38.120/harsh02.exe for known malicious executable), IP address (e.g. 185.130.5.231 for known attacker) or HTTP User-Agent header value (e.g. sqlmap for automatic SQL injection and database takeover tool). Also, it uses (optional) advanced heuristic mechanisms that can help in discovery of unknown threats (e.g. new malware).

[Shellcode Analysis Pipeline](https://7h3ram.github.io/2014/3/18/shellcode-pipeline/)
* I recently required an automated way of analyzing shellcode and verifying if it is detected by Libemu, Snort, Suricata, Bro, etc. Shellcode had to come from public sources like Shell-Storm, Exploit-DB and Metasploit. I needed an automated way of sourcing shellcode from these projects and pass it on to the analysis engines in a pipeline-like mechanism. This posts documents the method I used to complete this task and the overall progress of the project.

[packer-breaker](http://www.sysreveal.com/category/packerbreaker/)
* Unpacker for a variety of packing tools.

[INetSim](http://www.inetsim.org/)
* INetSim is a software suite for simulating common internet services in a lab environment, e.g. for analyzing the network behaviour of unknown malware samples. 
[Regshot](http://sourceforge.net/projects/regshot/)
Regshot is an open-source (LGPL) registry compare utility that allows you to quickly take a snapshot of your registry and then compare it with a second one - done after doing system changes or installing a new software product.

[Mandiant ApateDNS](https://www.mandiant.com/resources/download/research-tool-mandiant-apatedns)
* Mandiant ApateDNS is a tool for controlling DNS responses though an easy to use GUI. As a phony DNS server, Mandiant ApateDNS spoofs DNS responses to a user-specified IP address by listening on UDP port 53 on the local machine. Mandiant ApateDNS also automatically sets the local DNS to localhost. Upon exiting the tool, it sets back the original local DNS settings.

[Dependency Walker](http://www.dependencywalker.com/)
*  Dependency Walker is a free utility that scans any 32-bit or 64-bit Windows module (exe, dll, ocx, sys, etc.) and builds a hierarchical tree diagram of all dependent modules. For each module found, it lists all the functions that are exported by that module, and which of those functions are actually being called by other modules. Another view displays the minimum set of required files, along with detailed information about each file including a full path to the file, base address, version numbers, machine type, debug information, and more.

[Claimsman](Claimsman logs all file handle creation on Windows systems, and logs to both a local file and centralized log management system.)

[Malcom - Malware Communication Analyzer](https://github.com/tomchop/malcom)
* Malcom is a tool designed to analyze a system's network communication using graphical representations of network traffic, and cross-reference them with known malware sources. This comes handy when analyzing how certain malware species try to communicate with the outside world.

[ antivmdetection](https://github.com/nsmfoo/antivmdetection)
* Script to create templates to use with VirtualBox to make vm detection harder


[Bella](https://github.com/manwhoami/Bella)
* A pure python, post-exploitation, data mining tool and remote administration tool (RAT) for macOS / OS X.

[InfectPE](https://github.com/secrary/InfectPE)
* Using this tool you can inject x-code/shellcode into PE file. InjectPE works only with 32-bit executable files.

[Maltrail](https://github.com/stamparm/maltrail)
* Maltrail is a malicious traffic detection system, utilizing publicly available (black)lists containing malicious and/or generally suspicious trails, along with static trails compiled from various AV reports and custom user defined lists, where trail can be anything from domain name (e.g. zvpprsensinaix.com for Banjori malware), URL (e.g. http://109.162.38.120/harsh02.exe for known malicious executable), IP address (e.g. 185.130.5.231 for known attacker) or HTTP User-Agent header value (e.g. sqlmap for automatic SQL injection and database takeover tool). Also, it uses (optional) advanced heuristic mechanisms that can help in discovery of unknown threats (e.g. new malware).

[yalda - Gita Ziabari](https://github.com/fideliscyber/yalda)
* The tool is designed to analyze the given files and extract malicious data out of the files.
* [Presentation](https://www.youtube.com/watch?v=OPRqgEZXWOE)























### <a name="papers">Papers</a>

[SubVirt: Implementing malware with virtual machines](http://web.eecs.umich.edu/virtual/papers/king06.pdf)
* We evaluate a new type of malicious software that gains qualitatively more control over a system. This new type of malware, which we call a virtual-machine based rootkit (VMBR), installs a virtual-machine mon- itor underneath an existing operating system and hoists the original operating system into a virtual machine. Virtual-machine based rootkits are hard to detect and remove because their state cannot be accessed by soft- ware running in the target system. Further, VMBRs support general-purpose malicious services by allowing such services to run in a separate operating system that is protected from the target system. We evaluate this new threat by implementing two proof-of-concept VMBRs. We use our proof-of-concept VMBRs to sub- vert Windows XP and Linux target systems, and we implement four example malicious services using the VMBR platform. Last, we use what we learn from our proof-of-concept VMBRs to explore ways to defend against this new threat. We discuss possible ways to detect and prevent VMBRs, and we implement a de- fense strategy suitable for protecting systems against this threat.

[Modeling Zero Day Malware Spread](https://lqdc.github.io/modeling-zero-day-malware-spread.html

Duping the Machine: malware strategies, post sandbox detection
[Slide deck presentation](https://www.virusbtn.com/pdf/conference_slides/2014/Wyke-VB2014.pdf)

[PortEX: Robust static anaylsis of Portable Executable Malware](https://evilzone.org/reverse-engineering/%28pdf%29-robust-static-analysis-of-portable-executable-malware/)

[VirusTotal Mining](http://blog.9bplus.com/wp-content/uploads/2014/08/VirusTotal-Mining.pdf)

[Software Distribution Malware Infection Vector](http://dl.packetstormsecurity.net/papers/general/Software.Distribution.Malware.Infection.Vector.pdf)
* In this paper we present an efficient mechanism as well as  the  corresponding  reference  implementation  for  on- the-fly infecting of executable code with malicious soft- ware. Our algorithm deploys virus infection routines and network redirection attacks, without requiring to modify the application itself. This allows to even infect executa- bles with a embedded signature when the signature is not automatically verified before execution.  We briefly dis- cuss also countermeasures such as secure channels, code authentication  as  well  as  trusted  virtualization  that  en- ables the isolation of untrusted downloads from other ap- plication running in trusted domains or compartments.

[Statistical Structures: Fingerprinting Malware for Classification and Analysis - Daniel Bilar](https://www.blackhat.com/presentations/bh-usa-06/BH-US-06-Bilar.pdf)

[Malware Guard Extension: Using SGX to Conceal Cache Attacks](https://arxiv.org/abs/1702.08719)
* In this paper, we demonstrate fine-grained software-based side-channel attacks from a malicious SGX enclave targeting co-located enclaves. Our attack is the first malware running on real SGX hardware, abusing SGX protection features to conceal itself. Furthermore, we demonstrate our attack both in a native environment and across multiple Docker containers. We perform a Prime+Probe cache side-channel attack on a co-located SGX enclave running an up-to-date RSA implementation that uses a constant-time multiplication primitive. The attack works although in SGX enclaves there are no timers, no large pages, no physical addresses, and no shared memory. In a semi-synchronous attack, we extract 96% of an RSA private key from a single trace. We extract the full RSA private key in an automated attack from 11 traces within 5 minutes.

[PyTrigger: A System to Trigger & Extract User-Activated Malware Behavior](http://cs.gmu.edu/~astavrou/research/PyTrigger_ARES2013.pdf)
* Abstract: PyTrigger analyzes the system trace using a combination of multiple states and behavior differencing to accurately extract the malware behavior and user triggered behavior from the complete system trace log. We present the algorithms, architecture and evaluate the PyTrigger prototype using 3994 real malware samples. Results and analysis are presented showing PyTrigger extracts additional behavior in 21% of the samples.










### Talks

[Writing Bad @$$ Malware for OS X - Patrick Wardle](https://www.blackhat.com/docs/us-15/materials/us-15-Wardle-Writing-Bad-A-Malware-For-OS-X.pdf)

[Clean up on Aisle APT - Mark Parsons](https://www.irongeek.com/i.php?page=videos/bsidescharm2017/bsidescharm-2017-t101-clean-up-on-aisle-apt-mark-parsons)
* This presentation will discuss findings from running multiple sinkholes over the past year. I have purchased multiple domains associated with 'APT' activity after the domains have expired. I will discuss initial expectations before beginning this journey and then discuss actual results and findings. To assist other researchers, suggestions and lessons learned from this experiment will be shared.

[The Economics of Exploit Kits & E-Crime](http://www.irongeek.com/i.php?page=videos/bsidescolumbus2016/offense03-the-economics-of-exploit-kits-e-crime-adam-hogan)
* I will discuss how the market for exploit kits has been changing, in techniques, marketing and prices. I argue that the competitiveness between exploit kits shows a maturing market, but will leverage economic theory to demonstrate the limits to which that market will continue to mature. This should allow us to understand how exploit kits affect (and are affected by) the rest of the greater market for hacker services, from malware (as an input) to nation-state level attacks (e.g. trickle down from Hacking Team). I hope to provide a better understanding of how exploit kits work and how their sold as well as how this market can teach us about the rational choice to engage in criminal activity and how we might dissuade them.





### <a name="other">Other</a>

[Generate MS Office Macro Malware Script](https://github.com/enigma0x3/Generate-Macro/blob/master/Generate-Macro.ps1)
* Standalone Powershell script that will generate a malicious Microsoft Office document with a specified payload and persistence method

[Shellpaste](https://github.com/andrew-morris/shellpaste)
* Tiny snippet of code that pulls ASCII shellcode from pastebin and executes it. The purpose of this is to have a minimal amount of benign code so AV doesn't freak out, then it pulls down the evil stuff. People have been doing this kind of stuff for years so I take no credit for the concept. That being said, this code (or similar code) works surprisingly often during pentests when conventional malware fails. 
[PowerLoader Injection - Something truly amazing](http://www.malwaretech.com/2013/08/powerloader-injection-something-truly.html)


[Wepawet](https://wepawet.iseclab.org/)
* Wepawet is a free service, for non-commercial organizations, to detect and analyze web-based threats. It currently handles Flash, JavaScript, and PDF files

[JSRat-Py](https://github.com/Hood3dRob1n/JSRat-Py) 
* "implementation of JSRat.ps1 in Python so you can now run the attack server from any OS instead of being limited to a Windows OS with Powershell enabled"


[Computer Viruses In This Modern Age - alcopaul/brigada ocho 2014](http://spth.virii.lu/dc6/TEXTS/alcopaul/virus_alcopaul.txt)